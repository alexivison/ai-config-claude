# Deny Destructive Git Operations
# Prevents accidental data loss from irreversible git commands.
# Decision "prompt" forces explicit user confirmation before execution.

prefix_rule(
    pattern = ["git", "reset", "--hard"],
    decision = "prompt",
    justification = "Hard reset discards uncommitted changes permanently.",
    match = ["git reset --hard HEAD~1", "git reset --hard origin/main"],
    not_match = ["git reset --soft HEAD~1"],
)

prefix_rule(
    pattern = ["git", "clean", ["-f", "-fd", "-fx", "-fdx", "-fxd"]],
    decision = "prompt",
    justification = "git clean -f permanently deletes untracked files.",
    match = ["git clean -fd", "git clean -f"],
    not_match = ["git clean -n", "git clean --dry-run"],
)

prefix_rule(
    pattern = ["git", "checkout", "--"],
    decision = "prompt",
    justification = "Discards working tree changes for the specified file.",
    match = ["git checkout -- src/main.ts"],
)

prefix_rule(
    pattern = ["git", "stash", "drop"],
    decision = "prompt",
    justification = "Permanently removes a stash entry.",
    match = ["git stash drop stash@{0}"],
    not_match = ["git stash list", "git stash pop"],
)
